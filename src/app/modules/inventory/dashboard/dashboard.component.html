<!-- dashboard.component.html - SIMPLIFICADO -->
<div class="dashboard-container">

    <!-- Loading State -->
    <div *ngIf="cargando" class="loading-container">
        <div class="loading-spinner">‚ü≥</div>
        <p>Cargando datos del dashboard...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !cargando" class="error-container">
        <div class="error-icon">‚ö†Ô∏è</div>
        <p>{{error}}</p>
        <button class="btn-reintentar" (click)="cargarDatos()">
            Reintentar
        </button>
    </div>

    <!-- Dashboard Content -->
    <div *ngIf="dashboardData && !cargando" class="dashboard-grid">

        <!-- Header con filtros y bot√≥n de actualizaci√≥n -->
        <div class="dashboard-header">
            <div class="header-left">
                <h1>{{getTituloFecha()}}</h1>
                
                <!-- Filtros de fecha -->
                <div class="filtros-fecha">
                    <div class="filtro-grupo">
                        <label>Per√≠odo:</label>
                        <select [(ngModel)]="fechaSeleccionada" (change)="onFechaChange()" class="select-fecha">
                            <option *ngFor="let opcion of opcionesFecha" [value]="opcion.value">
                                {{opcion.label}}
                            </option>
                        </select>
                    </div>
                    
                    <!-- Fecha personalizada -->
                    <div class="filtro-grupo" *ngIf="mostrarFechaPersonalizada">
                        <label>Fecha:</label>
                        <input 
                            type="date" 
                            [(ngModel)]="fechaPersonalizada"
                            (change)="onFechaPersonalizadaChange()"
                            class="input-fecha-custom">
                    </div>
                </div>
            </div>
            
            <button class="btn-actualizar" (click)="actualizarDatos()" [disabled]="cargando">
                <span class="refresh-icon" [class.spinning]="cargando">üîÑ</span>
                Actualizar
            </button>
        </div>

        <!-- Grid principal con 4 cards -->
        <div class="cards-principales">
            
            <!-- Ventas del per√≠odo -->
            <div class="card ventas-periodo">
                <h3>üíµ Ventas del per√≠odo</h3>
                <p class="monto-principal">{{formatearMoneda(dashboardData.ventasDelDia.totalVentas)}}</p>
                <div class="ventas-detalle">
                    <span>{{dashboardData.ventasDelDia.cantidadPedidos}} pedidos</span>
                    <span>Promedio: {{formatearMoneda(dashboardData.ventasDelDia.promedioTicket)}}</span>
                </div>
            </div>

            <!-- Caja del per√≠odo -->
            <div class="card caja-periodo">
                <h3>üí∞ Caja del per√≠odo</h3>
                <ul class="lista-caja">
                    <li>Efectivo: {{formatearMoneda(dashboardData.cajaActual.efectivo)}}</li>
                    <li>Tarjeta: {{formatearMoneda(dashboardData.cajaActual.tarjeta)}}</li>
                    <li>Delivery: {{formatearMoneda(dashboardData.cajaActual.delivery)}}</li>
                    <li *ngIf="dashboardData.cajaActual.yape > 0">Yape: {{formatearMoneda(dashboardData.cajaActual.yape)}}</li>
                    <li *ngIf="dashboardData.cajaActual.plin > 0">Plin: {{formatearMoneda(dashboardData.cajaActual.plin)}}</li>
                </ul>
                <div class="total-caja">
                    <strong>Total: {{formatearMoneda(dashboardData.cajaActual.total)}}</strong>
                </div>
            </div>

            <!-- Stock cr√≠tico -->
            <div class="card stock-critico">
                <h3>üì¶ Stock cr√≠tico</h3>
                <ul class="lista-stock">
                    <li *ngFor="let item of stockCriticoLimitado">
                        {{item.nombreInsumo}} - {{item.stockActual}}{{item.unidadMedida}}
                    </li>
                </ul>
                <div class="stock-warning" *ngIf="dashboardData.stockCritico.length > 3">
                    +{{dashboardData.stockCritico.length - 3}} m√°s
                </div>
            </div>

            <!-- Producto m√°s vendido -->
            <div class="card producto-top">
                <h3>üçó Producto m√°s vendido</h3>
                <p class="nombre-producto">{{dashboardData.productoMasVendido.nombreProducto}}</p>
                <p class="cantidad-producto">{{dashboardData.productoMasVendido.cantidadVendida}} unidades</p>
                <div class="ingresos-producto">
                    {{formatearMoneda(dashboardData.productoMasVendido.totalIngresos)}}
                </div>
            </div>

        </div>

        <!-- Gr√°ficos -->
        <div class="graficos-container">
            
            <!-- Gr√°fico de ventas semanales -->
            <div class="card grafico-ventas-semanales">
                <div class="chart-header">
                    <h3>üìà Ventas √∫ltimos 7 d√≠as</h3>
                    <div class="chart-stats">
                        <span class="total-semanal">
                            Total: {{formatearMoneda(getTotalVentasSemanales())}}
                        </span>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="ventasLineChart"></canvas>
                </div>
            </div>

            <!-- Gr√°fico de ventas por categor√≠a -->
            <div class="card grafico-categorias">
                <div class="chart-header">
                    <h3>üìä Ventas por categor√≠a</h3>
                    <div class="chart-stats">
                        <span class="categorias-count">
                            {{getCantidadCategorias()}} categor√≠as
                        </span>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="ventasChart"></canvas>
                </div>
            </div>

        </div>

    </div>

</div>
