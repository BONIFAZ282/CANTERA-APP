
<div class="proveedores-container">

  <!-- Header -->
  <div class="header-section">
    <div class="title-container">
      <div class="icon-title">
        <span class="proveedores-icon">üè™</span>
        <div>
          <h1>Gesti√≥n de Proveedores</h1>
          <p class="subtitle">Administra los proveedores de La Cantera</p>
        </div>
      </div>
      <button class="btn-nuevo" (click)="abrirModalNuevo()">
        <span class="plus-icon">+</span>
        Nuevo Proveedor
      </button>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filtros-section">
    <div class="filtros-row">
      
      <div class="filtro-grupo">
        <label>Buscar proveedor</label>
        <input 
          type="text" 
          [(ngModel)]="filtros.nombre"
          placeholder="Nombre del proveedor..."
          class="input-buscar">
      </div>

      <div class="filtro-grupo">
        <label>RUC</label>
        <input 
          type="text" 
          [(ngModel)]="filtros.ruc"
          placeholder="N√∫mero de RUC..."
          class="input-buscar">
      </div>

      <div class="filtro-grupo">
        <label>Estado</label>
        <select [(ngModel)]="filtros.estado" class="select-filtro">
          <option value="todos">Todos</option>
          <option value="activos">Activos</option>
          <option value="inactivos">Inactivos</option>
        </select>
      </div>

    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="cargando" class="loading-container">
    <div class="loading-spinner">‚ü≥</div>
    <p>Cargando proveedores...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !cargando" class="error-container">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p>{{error}}</p>
  </div>

  <!-- Tabla de proveedores -->
  <div *ngIf="!cargando && !error" class="tabla-section">
    <div class="tabla-header">
      <h3>Proveedores ({{proveedoresFiltrados.length}})</h3>
    </div>

    <div class="tabla-container">
      <table class="proveedores-table">
        
        <thead>
          <tr>
            <th>Proveedor</th>
            <th>RUC</th>
            <th>Contacto</th>
            <th>Direcci√≥n</th>
            <th>Estado</th>
            <th>Acciones</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let proveedor of proveedoresFiltrados; let i = index" 
              [class.row-even]="i % 2 === 0"
              [class.inactive]="!proveedor.status">
            
            <td class="proveedor-column">
              <div class="proveedor-info">
                <div class="proveedor-avatar">
                  {{proveedor.supplierName.charAt(0)}}
                </div>
                <div class="proveedor-datos">
                  <div class="nombre-proveedor">
                    {{proveedor.supplierName}}
                  </div>
                </div>
              </div>
            </td>

            <td class="ruc-column">
              {{proveedor.ruc}}
            </td>

            <td class="contacto-column">
              <div class="contacto-info" *ngIf="proveedor.phone">
                üìû {{proveedor.phone}}
              </div>
            </td>

            <td class="direccion-column">
              {{proveedor.address || 'No especificado'}}
            </td>

            <td class="estado-column">
              <span class="estado-badge" 
                    [class.activo]="proveedor.status"
                    [class.inactivo]="!proveedor.status">
                {{proveedor.status ? 'Activo' : 'Inactivo'}}
              </span>
            </td>

            <td class="acciones-column">
              <div class="acciones-grupo">
                <button class="btn-accion editar" 
                        (click)="abrirModalEditar(proveedor)"
                        title="Editar">
                  ‚úèÔ∏è
                </button>
                <button class="btn-accion toggle" 
                        (click)="cambiarEstadoProveedor(proveedor)"
                        [title]="proveedor.status ? 'Desactivar' : 'Activar'">
                  {{proveedor.status ? 'üîí' : 'üîì'}}
                </button>
                <button class="btn-accion eliminar" 
                        (click)="eliminarProveedor(proveedor)"
                        title="Eliminar">
                  üóëÔ∏è
                </button>
              </div>
            </td>

          </tr>
        </tbody>

      </table>

      <div *ngIf="proveedoresFiltrados.length === 0" class="no-data">
        <p>No se encontraron proveedores</p>
      </div>

    </div>
  </div>

</div>

<!-- Modal para nuevo/editar proveedor -->
<div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    
    <div class="modal-header">
      <h2>{{editando ? 'Editar Proveedor' : 'Nuevo Proveedor'}}</h2>
      <button class="btn-cerrar" (click)="cerrarModal()">√ó</button>
    </div>

    <div class="modal-body">
      <form class="proveedor-form">
        
        <div class="form-row">
          <div class="form-grupo full-width">
            <label>Nombre del Proveedor *</label>
            <input type="text" 
                   [(ngModel)]="nuevoProveedor.supplierName"
                   name="nombre"
                   required
                   class="form-input">
          </div>
        </div>

        <div class="form-row">
          <div class="form-grupo">
            <label>RUC *</label>
            <input type="text" 
                   [(ngModel)]="nuevoProveedor.ruc"
                   name="ruc"
                   maxlength="11"
                   required
                   class="form-input">
          </div>
          <div class="form-grupo">
            <label>Tel√©fono</label>
            <input type="tel" 
                   [(ngModel)]="nuevoProveedor.phone"
                   name="telefono"
                   class="form-input">
          </div>
        </div>

        <div class="form-row">
          <div class="form-grupo full-width">
            <label>Direcci√≥n</label>
            <textarea [(ngModel)]="nuevoProveedor.address"
                      name="direccion"
                      rows="3"
                      class="form-textarea"></textarea>
          </div>
        </div>

        <div class="form-row">
          <div class="form-grupo">
            <div class="checkbox-grupo">
              <input type="checkbox" 
                     [(ngModel)]="nuevoProveedor.status"
                     name="activo"
                     id="activoProveedor">
              <label for="activoProveedor">Proveedor activo</label>
            </div>
          </div>
        </div>

      </form>
    </div>

    <div class="modal-footer">
      <button class="btn-cancelar" (click)="cerrarModal()">
        Cancelar
      </button>
      <button class="btn-guardar" (click)="guardarProveedor()">
        {{editando ? 'Actualizar' : 'Guardar'}}
      </button>
    </div>

  </div>
</div>
