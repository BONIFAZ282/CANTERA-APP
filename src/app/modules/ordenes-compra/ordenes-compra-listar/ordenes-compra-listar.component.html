<div class="dashboard-container">


  <div class="content-section">
    <div class="table-container">
      <div class="table-header">
        <div class="table-actions">
          <button class="btn-primary" (click)="agregarOrden()">
            <span class="btn-icon">‚ûï</span>
            Registrar nueva orden
          </button>
        </div>
        <p class="table-subtitle">Complete la informaci√≥n para gestionar las √≥rdenes de compra</p>
      </div>

      <div class="table-wrapper">
        <table class="modern-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Proveedor</th>
              <th>Fecha</th>
              <th>Total</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let orden of ordenesCompra" class="table-row">
              <td>
                <span class="order-id">#{{ orden.id }}</span>
              </td>
              <td>
                <div class="provider-info">
                  <span class="provider-name">{{ orden.nombreProveedor }}</span>
                  <span class="provider-id">ID: {{ orden.nProveedorId }}</span>
                </div>
              </td>
              <td>
                <span class="date-text">{{ formatearFecha(orden.dFecha) }}</span>
              </td>
              <td>
                <span class="amount-text">{{ formatearMoneda(orden.nTotal) }}</span>
              </td>
              <td>
                <select 
                  class="status-select"
                  [ngClass]="getEstadoClass(orden.nEstado)"
                  [value]="orden.nEstado"
                  (change)="cambiarEstado(orden.id, ($any($event.target)).value)">
                  <option *ngFor="let estado of estadosDisponibles" [value]="estado">
                    {{ estado }}
                  </option>
                </select>
              </td>
              <td>
                <div class="action-buttons">
                  <button 
                    class="btn-action btn-view"
                    (click)="verDetalle(orden)"
                    title="Ver detalles">
                    üëÅÔ∏è
                  </button>
                  <button 
                    class="btn-action btn-edit"
                    (click)="editarOrden(orden.id)"
                    title="Editar orden">
                    ‚úèÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- Estado vac√≠o -->
        <div *ngIf="ordenesCompra.length === 0" class="empty-state">
          <div class="empty-icon">üìã</div>
          <h3>No hay √≥rdenes de compra</h3>
          <p>Comienza creando tu primera orden de compra</p>
          <button class="btn-primary" (click)="agregarOrden()">
            Crear primera orden
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para ver detalles -->
<div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Detalles de la Orden #{{ ordenSeleccionada?.id }}</h3>
      <button class="btn-close" (click)="cerrarModal()">‚úï</button>
    </div>
    
    <div class="modal-body" *ngIf="ordenSeleccionada">
      <div class="order-summary">
        <div class="summary-row">
          <span class="summary-label">Proveedor:</span>
          <span class="summary-value">{{ ordenSeleccionada.nombreProveedor }}</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Fecha:</span>
          <span class="summary-value">{{ formatearFecha(ordenSeleccionada.dFecha) }}</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Estado:</span>
          <span class="summary-value status-badge" [ngClass]="getEstadoClass(ordenSeleccionada.nEstado)">
            {{ ordenSeleccionada.nEstado }}
          </span>
        </div>
      </div>

      <div class="details-section">
        <h4>Art√≠culos de la orden</h4>
        <div class="details-table">
          <div class="details-header">
            <span>Insumo</span>
            <span>Cantidad</span>
            <span>Precio Unit.</span>
            <span>Subtotal</span>
          </div>
          <div class="details-row" *ngFor="let detalle of ordenSeleccionada.detalles">
            <span class="item-name">{{ detalle.nombreInsumo }}</span>
            <span class="item-quantity">{{ detalle.nCantidad }}</span>
            <span class="item-price">{{ formatearMoneda(detalle.nPrecioUnitario) }}</span>
            <span class="item-subtotal">{{ formatearMoneda(detalle.subtotal) }}</span>
          </div>
        </div>
        
        <div class="total-section">
          <div class="total-row">
            <span class="total-label">Total:</span>
            <span class="total-amount">{{ formatearMoneda(ordenSeleccionada.nTotal) }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="cerrarModal()">Cerrar</button>
      <button class="btn-primary" (click)="cerrarModal(); editarOrden(ordenSeleccionada!.id)">
        ‚úèÔ∏è Editar orden
      </button>
    </div>
  </div>
</div>